!function(t){var e={};function n(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(r,s,function(e){return t[e]}.bind(null,s));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";n.r(e),n.d(e,"Expression",(function(){return S})),n.d(e,"Parser",(function(){return Ft}));var r="INUMBER",s="IOP1",i="IOP2",o="IOP3",a="IVAR",p="IVARNAME",u="IFUNCALL",h="IFUNDEF",c="IEXPR",l="IEXPREVAL",f="IMEMBER",x="IENDSTATEMENT",y="IARRAY";function v(t,e){this.type=t,this.value=null!=e?e:0}function M(t){return new v(s,t)}function d(t){return new v(i,t)}function w(t){return new v(o,t)}function g(t,e,n){var v,M,d,w,A,T,k=[];if(E(t))return b(t,n);for(var O=t.length,S=0;S<O;S++){var C=t[S],N=C.type;if(N===r||N===p)k.push(C.value);else if(N===i)M=k.pop(),v=k.pop(),"and"===C.value?k.push(!!v&&!!g(M,e,n)):"or"===C.value?k.push(!!v||!!g(M,e,n)):"="===C.value?(w=e.binaryOps[C.value],k.push(w(v,g(M,e,n),n))):(w=e.binaryOps[C.value],k.push(w(b(v,n),b(M,n))));else if(N===o)d=k.pop(),M=k.pop(),v=k.pop(),"?"===C.value?k.push(g(v?M:d,e,n)):(w=e.ternaryOps[C.value],k.push(w(b(v,n),b(M,n),b(d,n))));else if(N===a)if(C.value in e.functions)k.push(e.functions[C.value]);else if(C.value in e.unaryOps&&e.parser.isOperatorEnabled(C.value))k.push(e.unaryOps[C.value]);else{var P=n[C.value];if(void 0===P)throw new Error("undefined variable: "+C.value);k.push(P)}else if(N===s)v=k.pop(),w=e.unaryOps[C.value],k.push(w(b(v,n)));else if(N===u){for(T=C.value,A=[];T-- >0;)A.unshift(b(k.pop(),n));if(!(w=k.pop()).apply||!w.call)throw new Error(w+" is not a function");k.push(w.apply(void 0,A))}else if(N===h)k.push(function(){for(var t=k.pop(),r=[],s=C.value;s-- >0;)r.unshift(k.pop());var i=k.pop(),o=function(){for(var s=Object.assign({},n),i=0,o=r.length;i<o;i++)s[r[i]]=arguments[i];return g(t,e,s)};return Object.defineProperty(o,"name",{value:i,writable:!1}),n[i]=o,o}());else if(N===c)k.push(m(C,e));else if(N===l)k.push(C);else if(N===f)v=k.pop(),k.push(v[C.value]);else if(N===x)k.pop();else{if(N!==y)throw new Error("invalid Expression");for(T=C.value,A=[];T-- >0;)A.unshift(k.pop());k.push(A)}}if(k.length>1)throw new Error("invalid Expression (parity)");return 0===k[0]?0:b(k[0],n)}function m(t,e,n){return E(t)?t:{type:l,value:function(n){return g(t.value,e,n)}}}function E(t){return t&&t.type===l}function b(t,e){return E(t)?t.value(e):t}function A(t,e){for(var n,l,v,M,d,w,g=[],m=0;m<t.length;m++){var E=t[m],b=E.type;if(b===r)"number"==typeof E.value&&E.value<0?g.push("("+E.value+")"):Array.isArray(E.value)?g.push("["+E.value.map(T).join(", ")+"]"):g.push(T(E.value));else if(b===i)l=g.pop(),n=g.pop(),M=E.value,e?"^"===M?g.push("Math.pow("+n+", "+l+")"):"and"===M?g.push("(!!"+n+" && !!"+l+")"):"or"===M?g.push("(!!"+n+" || !!"+l+")"):"||"===M?g.push("(function(a,b){ return Array.isArray(a) && Array.isArray(b) ? a.concat(b) : String(a) + String(b); }(("+n+"),("+l+")))"):"=="===M?g.push("("+n+" === "+l+")"):"!="===M?g.push("("+n+" !== "+l+")"):"["===M?g.push(n+"[("+l+") | 0]"):g.push("("+n+" "+M+" "+l+")"):"["===M?g.push(n+"["+l+"]"):g.push("("+n+" "+M+" "+l+")");else if(b===o){if(v=g.pop(),l=g.pop(),n=g.pop(),"?"!==(M=E.value))throw new Error("invalid Expression");g.push("("+n+" ? "+l+" : "+v+")")}else if(b===a||b===p)g.push(E.value);else if(b===s)n=g.pop(),"-"===(M=E.value)||"+"===M?g.push("("+M+n+")"):e?"not"===M?g.push("(!"+n+")"):"!"===M?g.push("fac("+n+")"):g.push(M+"("+n+")"):"!"===M?g.push("("+n+"!)"):g.push("("+M+" "+n+")");else if(b===u){for(w=E.value,d=[];w-- >0;)d.unshift(g.pop());M=g.pop(),g.push(M+"("+d.join(", ")+")")}else if(b===h){for(l=g.pop(),w=E.value,d=[];w-- >0;)d.unshift(g.pop());n=g.pop(),e?g.push("("+n+" = function("+d.join(", ")+") { return "+l+" })"):g.push("("+n+"("+d.join(", ")+") = "+l+")")}else if(b===f)n=g.pop(),g.push(n+"."+E.value);else if(b===y){for(w=E.value,d=[];w-- >0;)d.unshift(g.pop());g.push("["+d.join(", ")+"]")}else if(b===c)g.push("("+A(E.value,e)+")");else if(b!==x)throw new Error("invalid Expression")}return g.length>1&&(g=e?[g.join(",")]:[g.join(";")]),String(g[0])}function T(t){return"string"==typeof t?JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):t}function k(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function O(t,e,n){for(var r=!!(n=n||{}).withMembers,s=null,i=0;i<t.length;i++){var o=t[i];o.type===a||o.type===p?r||k(e,o.value)?null!==s?(k(e,s)||e.push(s),s=o.value):s=o.value:e.push(o.value):o.type===f&&r&&null!==s?s+="."+o.value:o.type===c?O(o.value,e,n):null!==s&&(k(e,s)||e.push(s),s=null)}null===s||k(e,s)||e.push(s)}function S(t,e){this.tokens=t,this.parser=e,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.functions=e.functions}v.prototype.toString=function(){switch(this.type){case r:case s:case i:case o:case a:case p:case x:return this.value;case u:return"CALL "+this.value;case h:return"DEF "+this.value;case y:return"ARRAY "+this.value;case f:return"."+this.value;default:return"Invalid Instruction"}},S.prototype.simplify=function(t){return t=t||{},new S(function t(e,n,u,h,l){for(var x,M,d,w,g=[],m=[],E=0;E<e.length;E++){var b=e[E],A=b.type;if(A===r||A===p)Array.isArray(b.value)?g.push.apply(g,t(b.value.map((function(t){return new v(r,t)})).concat(new v(y,b.value.length)),n,u,h,l)):g.push(b);else if(A===a&&l.hasOwnProperty(b.value))b=new v(r,l[b.value]),g.push(b);else if(A===i&&g.length>1)M=g.pop(),x=g.pop(),w=u[b.value],b=new v(r,w(x.value,M.value)),g.push(b);else if(A===o&&g.length>2)d=g.pop(),M=g.pop(),x=g.pop(),"?"===b.value?g.push(x.value?M.value:d.value):(w=h[b.value],b=new v(r,w(x.value,M.value,d.value)),g.push(b));else if(A===s&&g.length>0)x=g.pop(),w=n[b.value],b=new v(r,w(x.value)),g.push(b);else if(A===c){for(;g.length>0;)m.push(g.shift());m.push(new v(c,t(b.value,n,u,h,l)))}else if(A===f&&g.length>0)x=g.pop(),g.push(new v(r,x.value[b.value]));else{for(;g.length>0;)m.push(g.shift());m.push(b)}}for(;g.length>0;)m.push(g.shift());return m}(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,t),this.parser)},S.prototype.substitute=function(t,e){return e instanceof S||(e=this.parser.parse(String(e))),new S(function t(e,n,r){for(var p=[],u=0;u<e.length;u++){var h=e[u],l=h.type;if(l===a&&h.value===n)for(var f=0;f<r.tokens.length;f++){var x,y=r.tokens[f];x=y.type===s?M(y.value):y.type===i?d(y.value):y.type===o?w(y.value):new v(y.type,y.value),p.push(x)}else l===c?p.push(new v(c,t(h.value,n,r))):p.push(h)}return p}(this.tokens,t,e),this.parser)},S.prototype.evaluate=function(t){return t=t||{},g(this.tokens,this,t)},S.prototype.toString=function(){return A(this.tokens,!1)},S.prototype.symbols=function(t){t=t||{};var e=[];return O(this.tokens,e,t),e},S.prototype.variables=function(t){t=t||{};var e=[];O(this.tokens,e,t);var n=this.functions;return e.filter((function(t){return!(t in n)}))},S.prototype.toJSFunction=function(t,e){var n=this,r=new Function(t,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+A(this.simplify(e).tokens,!0)+"; }");return function(){return r.apply(n,arguments)}};var C="TOP",N="TPAREN";function P(t,e,n){this.type=t,this.value=e,this.index=n}function I(t,e){this.pos=0,this.current=null,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.consts=t.consts,this.expression=e,this.savedPosition=0,this.savedCurrent=null,this.options=t.options,this.parser=t}P.prototype.toString=function(){return this.type+": "+this.value},I.prototype.newToken=function(t,e,n){return new P(t,e,null!=n?n:this.pos)},I.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current},I.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent},I.prototype.next=function(){return this.pos>=this.expression.length?this.newToken("TEOF","EOF"):this.isWhitespace()||this.isComment()?this.next():this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isBracket()||this.isComma()||this.isSemicolon()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},I.prototype.isString=function(){var t=!1,e=this.pos,n=this.expression.charAt(e);if("'"===n||'"'===n)for(var r=this.expression.indexOf(n,e+1);r>=0&&this.pos<this.expression.length;){if(this.pos=r+1,"\\"!==this.expression.charAt(r-1)){var s=this.expression.substring(e+1,r);this.current=this.newToken("TSTRING",this.unescape(s),e),t=!0;break}r=this.expression.indexOf(n,r+1)}return t},I.prototype.isParen=function(){var t=this.expression.charAt(this.pos);return("("===t||")"===t)&&(this.current=this.newToken(N,t),this.pos++,!0)},I.prototype.isBracket=function(){var t=this.expression.charAt(this.pos);return!("["!==t&&"]"!==t||!this.isOperatorEnabled("["))&&(this.current=this.newToken("TBRACKET",t),this.pos++,!0)},I.prototype.isComma=function(){return","===this.expression.charAt(this.pos)&&(this.current=this.newToken("TCOMMA",","),this.pos++,!0)},I.prototype.isSemicolon=function(){return";"===this.expression.charAt(this.pos)&&(this.current=this.newToken("TSEMICOLON",";"),this.pos++,!0)},I.prototype.isConst=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&"."!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(r in this.consts)return this.current=this.newToken("TNUMBER",this.consts[r]),this.pos+=r.length,!0}return!1},I.prototype.isNamedOp=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(this.isOperatorEnabled(r)&&(r in this.binaryOps||r in this.unaryOps||r in this.ternaryOps))return this.current=this.newToken(C,r),this.pos+=r.length,!0}return!1},I.prototype.isName=function(){for(var t=this.pos,e=t,n=!1;e<this.expression.length;e++){var r=this.expression.charAt(e);if(r.toUpperCase()===r.toLowerCase()){if(e===this.pos&&("$"===r||"_"===r)){"_"===r&&(n=!0);continue}if(e===this.pos||!n||"_"!==r&&(r<"0"||r>"9"))break}else n=!0}if(n){var s=this.expression.substring(t,e);return this.current=this.newToken("TNAME",s),this.pos+=s.length,!0}return!1},I.prototype.isWhitespace=function(){for(var t=!1,e=this.expression.charAt(this.pos);!(" "!==e&&"\t"!==e&&"\n"!==e&&"\r"!==e||(t=!0,this.pos++,this.pos>=this.expression.length));)e=this.expression.charAt(this.pos);return t};var F=/^[0-9a-f]{4}$/i;function R(t,e,n){this.parser=t,this.tokens=e,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=!1!==n.allowMemberAccess}I.prototype.unescape=function(t){var e=t.indexOf("\\");if(e<0)return t;for(var n=t.substring(0,e);e>=0;){var r=t.charAt(++e);switch(r){case"'":n+="'";break;case'"':n+='"';break;case"\\":n+="\\";break;case"/":n+="/";break;case"b":n+="\b";break;case"f":n+="\f";break;case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"u":var s=t.substring(e+1,e+5);F.test(s)||this.parseError("Illegal escape sequence: \\u"+s),n+=String.fromCharCode(parseInt(s,16)),e+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+r+'"')}++e;var i=t.indexOf("\\",e);n+=t.substring(e,i<0?t.length:i),e=i}return n},I.prototype.isComment=function(){return"/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)},I.prototype.isRadixInteger=function(){var t,e,n=this.pos;if(n>=this.expression.length-2||"0"!==this.expression.charAt(n))return!1;if(++n,"x"===this.expression.charAt(n))t=16,e=/^[0-9a-f]$/i,++n;else{if("b"!==this.expression.charAt(n))return!1;t=2,e=/^[01]$/i,++n}for(var r=!1,s=n;n<this.expression.length;){var i=this.expression.charAt(n);if(!e.test(i))break;n++,r=!0}return r&&(this.current=this.newToken("TNUMBER",parseInt(this.expression.substring(s,n),t)),this.pos=n),r},I.prototype.isNumber=function(){for(var t,e=!1,n=this.pos,r=n,s=n,i=!1,o=!1;n<this.expression.length&&((t=this.expression.charAt(n))>="0"&&t<="9"||!i&&"."===t);)"."===t?i=!0:o=!0,n++,e=o;if(e&&(s=n),"e"===t||"E"===t){n++;for(var a=!0,p=!1;n<this.expression.length;){if(t=this.expression.charAt(n),!a||"+"!==t&&"-"!==t){if(!(t>="0"&&t<="9"))break;p=!0,a=!1}else a=!1;n++}p||(n=s)}return e?(this.current=this.newToken("TNUMBER",parseFloat(this.expression.substring(r,n))),this.pos=n):this.pos=s,e},I.prototype.isOperator=function(){var t=this.pos,e=this.expression.charAt(this.pos);if("+"===e||"-"===e||"*"===e||"/"===e||"%"===e||"^"===e||"?"===e||":"===e||"."===e)this.current=this.newToken(C,e);else if("∙"===e||"•"===e)this.current=this.newToken(C,"*");else if(">"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(C,">="),this.pos++):this.current=this.newToken(C,">");else if("<"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(C,"<="),this.pos++):this.current=this.newToken(C,"<");else if("|"===e){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(C,"||"),this.pos++}else if("="===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(C,"=="),this.pos++):this.current=this.newToken(C,e);else{if("!"!==e)return!1;"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(C,"!="),this.pos++):this.current=this.newToken(C,e)}return this.pos++,!!this.isOperatorEnabled(this.current.value)||(this.pos=t,!1)},I.prototype.isOperatorEnabled=function(t){return this.parser.isOperatorEnabled(t)},I.prototype.getCoordinates=function(){var t,e=0,n=-1;do{e++,t=this.pos-n,n=this.expression.indexOf("\n",n+1)}while(n>=0&&n<this.pos);return{line:e,column:t}},I.prototype.parseError=function(t){var e=this.getCoordinates();throw new Error("parse error ["+e.line+":"+e.column+"]: "+t)},R.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},R.prototype.tokenMatches=function(t,e){return void 0===e||(Array.isArray(e)?k(e,t.value):"function"==typeof e?e(t):t.value===e)},R.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()},R.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken},R.prototype.accept=function(t,e){return!(this.nextToken.type!==t||!this.tokenMatches(this.nextToken,e))&&(this.next(),!0)},R.prototype.expect=function(t,e){if(!this.accept(t,e)){var n=this.tokens.getCoordinates();throw new Error("parse error ["+n.line+":"+n.column+"]: Expected "+(e||t))}},R.prototype.parseAtom=function(t){var e=this.tokens.unaryOps;if(this.accept("TNAME")||this.accept(C,(function(t){return t.value in e})))t.push(new v(a,this.current.value));else if(this.accept("TNUMBER"))t.push(new v(r,this.current.value));else if(this.accept("TSTRING"))t.push(new v(r,this.current.value));else if(this.accept(N,"("))this.parseExpression(t),this.expect(N,")");else{if(!this.accept("TBRACKET","["))throw new Error("unexpected "+this.nextToken);if(this.accept("TBRACKET","]"))t.push(new v(y,0));else{var n=this.parseArrayList(t);t.push(new v(y,n))}}},R.prototype.parseExpression=function(t){var e=[];this.parseUntilEndStatement(t,e)||(this.parseVariableAssignmentExpression(e),this.parseUntilEndStatement(t,e)||this.pushExpression(t,e))},R.prototype.pushExpression=function(t,e){for(var n=0,r=e.length;n<r;n++)t.push(e[n])},R.prototype.parseUntilEndStatement=function(t,e){return!!this.accept("TSEMICOLON")&&(!this.nextToken||"TEOF"===this.nextToken.type||this.nextToken.type===N&&")"===this.nextToken.value||e.push(new v(x)),"TEOF"!==this.nextToken.type&&this.parseExpression(e),t.push(new v(c,e)),!0)},R.prototype.parseArrayList=function(t){for(var e=0;!this.accept("TBRACKET","]");)for(this.parseExpression(t),++e;this.accept("TCOMMA");)this.parseExpression(t),++e;return e},R.prototype.parseVariableAssignmentExpression=function(t){for(this.parseConditionalExpression(t);this.accept(C,"=");){var e=t.pop(),n=[],r=t.length-1;if(e.type!==u){if(e.type!==a&&e.type!==f)throw new Error("expected variable for assignment");this.parseVariableAssignmentExpression(n),t.push(new v(p,e.value)),t.push(new v(c,n)),t.push(d("="))}else{if(!this.tokens.isOperatorEnabled("()="))throw new Error("function definition is not permitted");for(var s=0,i=e.value+1;s<i;s++){var o=r-s;t[o].type===a&&(t[o]=new v(p,t[o].value))}this.parseVariableAssignmentExpression(n),t.push(new v(c,n)),t.push(new v(h,e.value))}}},R.prototype.parseConditionalExpression=function(t){for(this.parseOrExpression(t);this.accept(C,"?");){var e=[],n=[];this.parseConditionalExpression(e),this.expect(C,":"),this.parseConditionalExpression(n),t.push(new v(c,e)),t.push(new v(c,n)),t.push(w("?"))}},R.prototype.parseOrExpression=function(t){for(this.parseAndExpression(t);this.accept(C,"or");){var e=[];this.parseAndExpression(e),t.push(new v(c,e)),t.push(d("or"))}},R.prototype.parseAndExpression=function(t){for(this.parseComparison(t);this.accept(C,"and");){var e=[];this.parseComparison(e),t.push(new v(c,e)),t.push(d("and"))}};var L=["==","!=","<","<=",">=",">","in"];R.prototype.parseComparison=function(t){for(this.parseAddSub(t);this.accept(C,L);){var e=this.current;this.parseAddSub(t),t.push(d(e.value))}};var j=["+","-","||"];R.prototype.parseAddSub=function(t){for(this.parseTerm(t);this.accept(C,j);){var e=this.current;this.parseTerm(t),t.push(d(e.value))}};var B=["*","/","%"];function U(t,e){return Number(t)+Number(e)}function q(t,e){return t-e}function _(t,e){return t*e}function V(t,e){return t/e}function K(t,e){return t%e}function W(t,e){return Array.isArray(t)&&Array.isArray(e)?t.concat(e):""+t+e}function Y(t,e){return t===e}function D(t,e){return t!==e}function $(t,e){return t>e}function G(t,e){return t<e}function X(t,e){return t>=e}function H(t,e){return t<=e}function J(t,e){return Boolean(t&&e)}function z(t,e){return Boolean(t||e)}function Q(t,e){return k(e,t)}function Z(t){return(Math.exp(t)-Math.exp(-t))/2}function tt(t){return(Math.exp(t)+Math.exp(-t))/2}function et(t){return t===1/0?1:t===-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function nt(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))}function rt(t){return Math.log(t+Math.sqrt(t*t-1))}function st(t){return Math.log((1+t)/(1-t))/2}function it(t){return Math.log(t)*Math.LOG10E}function ot(t){return-t}function at(t){return!t}function pt(t){return t<0?Math.ceil(t):Math.floor(t)}function ut(t){return Math.random()*(t||1)}function ht(t){return ft(t+1)}R.prototype.parseTerm=function(t){for(this.parseFactor(t);this.accept(C,B);){var e=this.current;this.parseFactor(t),t.push(d(e.value))}},R.prototype.parseFactor=function(t){var e=this.tokens.unaryOps;if(this.save(),this.accept(C,(function(t){return t.value in e}))){if("-"!==this.current.value&&"+"!==this.current.value){if(this.nextToken.type===N&&"("===this.nextToken.value)return this.restore(),void this.parseExponential(t);if("TSEMICOLON"===this.nextToken.type||"TCOMMA"===this.nextToken.type||"TEOF"===this.nextToken.type||this.nextToken.type===N&&")"===this.nextToken.value)return this.restore(),void this.parseAtom(t)}var n=this.current;this.parseFactor(t),t.push(M(n.value))}else this.parseExponential(t)},R.prototype.parseExponential=function(t){for(this.parsePostfixExpression(t);this.accept(C,"^");)this.parseFactor(t),t.push(d("^"))},R.prototype.parsePostfixExpression=function(t){for(this.parseFunctionCall(t);this.accept(C,"!");)t.push(M("!"))},R.prototype.parseFunctionCall=function(t){var e=this.tokens.unaryOps;if(this.accept(C,(function(t){return t.value in e}))){var n=this.current;this.parseAtom(t),t.push(M(n.value))}else for(this.parseMemberExpression(t);this.accept(N,"(");)if(this.accept(N,")"))t.push(new v(u,0));else{var r=this.parseArgumentList(t);t.push(new v(u,r))}},R.prototype.parseArgumentList=function(t){for(var e=0;!this.accept(N,")");)for(this.parseExpression(t),++e;this.accept("TCOMMA");)this.parseExpression(t),++e;return e},R.prototype.parseMemberExpression=function(t){for(this.parseAtom(t);this.accept(C,".")||this.accept("TBRACKET","[");){var e=this.current;if("."===e.value){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect("TNAME"),t.push(new v(f,this.current.value))}else{if("["!==e.value)throw new Error("unexpected symbol: "+e.value);if(!this.tokens.isOperatorEnabled("["))throw new Error('unexpected "[]", arrays are disabled');this.parseExpression(t),this.expect("TBRACKET","]"),t.push(d("["))}}};var ct=4.7421875,lt=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function ft(t){var e,n;if(function(t){return isFinite(t)&&t===Math.round(t)}(t)){if(t<=0)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(var r=t-2,s=t-1;r>1;)s*=r,r--;return 0===s&&(s=1),s}if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*ft(1-t));if(t>=171.35)return 1/0;if(t>85){var i=t*t,o=i*t,a=o*t,p=a*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*i)-139/(51840*o)-571/(2488320*a)+163879/(209018880*p)+5246819/(75246796800*p*t))}--t,n=lt[0];for(var u=1;u<lt.length;++u)n+=lt[u]/(t+u);return e=t+ct+.5,Math.sqrt(2*Math.PI)*Math.pow(e,t+.5)*Math.exp(-e)*n}function xt(t){return Array.isArray(t)?t.length:String(t).length}function yt(){for(var t=0,e=0,n=0;n<arguments.length;n++){var r,s=Math.abs(arguments[n]);e<s?(t=t*(r=e/s)*r+1,e=s):t+=s>0?(r=s/e)*r:s}return e===1/0?1/0:e*Math.sqrt(t)}function vt(t,e,n){return t?e:n}function Mt(t,e){return void 0===e||0==+e?Math.round(t):(t=+t,e=-+e,isNaN(t)||"number"!=typeof e||e%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math.round(+(t[0]+"e"+(t[1]?+t[1]-e:-e)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+e:e))))}function dt(t,e,n){return n&&(n[t]=e),e}function wt(t,e){return t[0|e]}function gt(t){return 1===arguments.length&&Array.isArray(t)?Math.max.apply(Math,t):Math.max.apply(Math,arguments)}function mt(t){return 1===arguments.length&&Array.isArray(t)?Math.min.apply(Math,t):Math.min.apply(Math,arguments)}function Et(t,e){if("function"!=typeof t)throw new Error("First argument to map is not a function");if(!Array.isArray(e))throw new Error("Second argument to map is not an array");return e.map((function(e,n){return t(e,n)}))}function bt(t,e,n){if("function"!=typeof t)throw new Error("First argument to fold is not a function");if(!Array.isArray(n))throw new Error("Second argument to fold is not an array");return n.reduce((function(e,n,r){return t(e,n,r)}),e)}function At(t,e){if("function"!=typeof t)throw new Error("First argument to filter is not a function");if(!Array.isArray(e))throw new Error("Second argument to filter is not an array");return e.filter((function(e,n){return t(e,n)}))}function Tt(t,e){if(!Array.isArray(e)&&"string"!=typeof e)throw new Error("Second argument to indexOf is not a string or array");return e.indexOf(t)}function kt(t,e){if(!Array.isArray(e))throw new Error("Second argument to join is not an array");return e.join(t)}function Ot(t){return(t>0)-(t<0)||+t}var St=1/3;function Ct(t){return t<0?-Math.pow(-t,St):Math.pow(t,St)}function Nt(t){return Math.exp(t)-1}function Pt(t){return Math.log(1+t)}function It(t){return Math.log(t)/Math.LN2}function Ft(t){this.options=t||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||Z,cosh:Math.cosh||tt,tanh:Math.tanh||et,asinh:Math.asinh||nt,acosh:Math.acosh||rt,atanh:Math.atanh||st,sqrt:Math.sqrt,cbrt:Math.cbrt||Ct,log:Math.log,log2:Math.log2||It,ln:Math.log,lg:Math.log10||it,log10:Math.log10||it,expm1:Math.expm1||Nt,log1p:Math.log1p||Pt,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||pt,"-":ot,"+":Number,exp:Math.exp,not:at,length:xt,"!":ht,sign:Math.sign||Ot},this.binaryOps={"+":U,"-":q,"*":_,"/":V,"%":K,"^":Math.pow,"||":W,"==":Y,"!=":D,">":$,"<":G,">=":X,"<=":H,and:J,or:z,in:Q,"=":dt,"[":wt},this.ternaryOps={"?":vt},this.functions={random:ut,fac:ht,min:mt,max:gt,hypot:Math.hypot||yt,pyt:Math.hypot||yt,pow:Math.pow,atan2:Math.atan2,if:vt,gamma:ft,roundTo:Mt,map:Et,fold:bt,filter:At,indexOf:Tt,join:kt},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}Ft.prototype.parse=function(t){var e=[],n=new R(this,new I(this,t),{allowMemberAccess:this.options.allowMemberAccess});return n.parseExpression(e),n.expect("TEOF","EOF"),new S(e,this)},Ft.prototype.evaluate=function(t,e){return this.parse(t).evaluate(e)};var Rt=new Ft;Ft.parse=function(t){return Rt.parse(t)},Ft.evaluate=function(t,e){return Rt.parse(t).evaluate(e)};var Lt={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional","=":"assignment","[":"array","()=":"fndef"};Ft.prototype.isOperatorEnabled=function(t){var e=function(t){return Lt.hasOwnProperty(t)?Lt[t]:t}(t),n=this.options.operators||{};return!(e in n&&!n[e])};
/*!
 Based on ndef.parser, by Raphael Graf(r@undefined.ch)
 http://www.undefined.ch/mparser/index.html

 Ported to JavaScript and modified by Matthew Crumley (email@matthewcrumley.com, http://silentmatt.com/)

 You are free to use and modify this code in anyway you find useful. Please leave this comment in the code
 to acknowledge its original source. If you feel like it, I enjoy hearing about projects that use my code,
 but don't feel like you have to let me know or ask permission.
*/
var jt={Parser:Ft,Expression:S};e.default=jt},function(t,e,n){"use strict";function r(t){this.canvas=t,this.ctx=t.getContext("2d")}n.r(e),r.prototype.fill=function(t){this.canvas.fillStyle=t},r.prototype.line=function(t,e,n,r,s="black"){this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(n,r),this.ctx.strokeStyle=s,this.ctx.stroke()},r.prototype.text=function(t,e,n,r=10*canvas.scale){this.ctx.font=r+"px Arial",this.ctx.fillText(t,e,n)},r.prototype.rect=function(t,e,n,r,s="white"){this.ctx.fillStyle=s,this.ctx.fillRect(t,e,n,r)};var s=new(0,n(0).Parser);let i=document.getElementById("canvas"),o=i.getContext("2d");i.trueHeight=i.height,i.trueWidth=i.width,i.scale=2,i.style.width=i.width+"px",i.style.height=i.height+"px",i.width*=i.scale,i.height*=i.scale;let a=new r(i),p={xScale:4,yScale:4,xMin:-22.5,xMax:22.5,yMin:-22.5,yMax:22.5,function:""};function u(t,e){return{x:(t-p.xMin)/(p.xMax-p.xMin)*i.width,y:(p.yMax-e)/(p.yMax-p.yMin)*i.width}}function h(t,e="black"){let n=function(t){return s.parse(t)}(t);for(let t=0;t<1e3;t++){let r=p.xMin+t/1e3*(p.xMax-p.xMin),s=p.xMin+(t+1)*(p.xMax-p.xMin)/1e3,i=n.evaluate({x:r}),o=n.evaluate({x:s});a.line(u(r,0).x,u(0,i).y,u(s,0).x,u(0,o).y,e)}}function c(){let t=function(){let t=p.xScale,e=p.yScale,n=(p.xMax-p.xMin)/t,r=(p.yMax-p.yMin)/e;for(;n>12;)t*=2,n=(p.xMax-p.xMin)/t;for(;n<4;)t/=2,n=(p.xMax-p.xMin)/t;for(;r>12;)e*=2,r=(p.yMax-p.yMin)/e;for(;r<4;)e/=2,r=(p.yMax-p.yMin)/e;return{xScale:t,yScale:e}}();p.xScale=t.xScale,p.yScale=t.yScale,a.rect(0,0,i.width,i.height),function(){o.lineWidth=i.scale;let t={min:Math.ceil(p.xMin/p.xScale),max:Math.floor(p.xMax/p.xScale)},e={min:Math.ceil(p.yMin/p.yScale),max:Math.floor(p.yMax/p.yScale)};for(let e=t.min;e<=t.max;e++){if(0==e)continue;let t=u(e*p.xScale,0).x;u(0,0).y;a.line(t,0,t,i.height,"lightgray")}for(let t=e.min;t<=e.max;t++){if(0==t)continue;u(0,0).x;let e=u(0,t*p.yScale).y;a.line(0,e,i.width,e,"lightgray")}}(),function(){o.fillStyle="black",o.lineWidth=1.5*i.scale,a.line(0,u(0,0).y,i.width,u(0,0).y),a.line(u(0,0).x,0,u(0,0).x,i.height),o.textBaseline="middle";let t={min:Math.ceil(p.xMin/p.xScale),max:Math.floor(p.xMax/p.xScale)};for(let e=t.min;e<=t.max;e++){if(o.textAlign="center",0==e)continue;let t=parseFloat((e*p.xScale).toPrecision(4)),n=u(e*p.xScale,0).x,r=u(0,0).y;a.line(n,r+5*i.scale,n,r-5*i.scale),a.text(t,n,r+15*i.scale)}let e={min:Math.ceil(p.yMin/p.yScale),max:Math.floor(p.yMax/p.yScale)};for(let t=e.min;t<=e.max;t++){if(0==t)continue;o.textAlign="end";let e=parseFloat((t*p.yScale).toPrecision(4)),n=u(0,0).x,r=u(0,t*p.yScale).y;a.line(n-5*i.scale,r,n+5*i.scale,r),a.text(e,n-10*i.scale,r)}}(),p.function&&h(p.function,"blue")}let l,f=!1;function x(t){let e=i.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}function y(t,e){let n=p.xMax-p.xMin,r=p.yMax-p.yMin;return{x:p.xMin+t/i.trueWidth*n,y:p.yMax-e/i.trueHeight*r}}c(),i.addEventListener("mousedown",(function(t){l=x(t),f=!0,x(t)})),document.addEventListener("mouseup",(function(){f=!1})),i.addEventListener("mousemove",(function(t){if(f){let e=x(t),n=y(e.x,0).x-y(l.x,0).x,r=y(0,e.y).y-y(0,l.y).y;p.xMin-=n,p.xMax-=n,p.yMin-=r,p.yMax-=r,l=e,c()}})),i.addEventListener("wheel",(function(t){let e=x(t),n=y(e.x,e.y),r=n.x-p.xMin,s=p.xMax-n.x,i=p.yMax-n.y,o=n.y-p.yMin;t.deltaY>0?(p.xMin-=.05*r,p.xMax+=.05*s,p.yMin-=.05*o,p.yMax+=.05*i):t.deltaY<0&&(p.xMin+=.05*r,p.xMax-=.05*s,p.yMin+=.05*o,p.yMax-=.05*i),c(),t.preventDefault()})),document.querySelector(".functions > button").addEventListener("click",(function(){p.function=document.querySelector('.functions > input[name="y1"]').value,c()}))}]);